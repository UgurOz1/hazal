[uwsgi]
# Application module
module = app:app

# Process management
master = true
processes = 4
threads = 2
enable-threads = true

# Socket configuration
socket = /tmp/uwsgi.sock
chmod-socket = 666
chown-socket = www-data:www-data

# Performance settings
buffer-size = 32768
max-requests = 1000
max-requests-delta = 100
harakiri = 30
harakiri-verbose = true

# Memory management
reload-on-rss = 512
evil-reload-on-rss = 1024

# Logging
logto = /var/log/uwsgi/flask-user-management.log
log-maxsize = 50000000
log-backupname = /var/log/uwsgi/flask-user-management.log.old

# Security
uid = www-data
gid = www-data
umask = 002

# Process cleanup
vacuum = true
die-on-term = true
lazy-apps = true

# Stats and monitoring
stats = /tmp/uwsgi-stats.sock
stats-http = true

# Environment variables
env = FLASK_ENV=production
env = PYTHONPATH=/var/www/flask-user-management

# Plugin configuration
plugin = python3

# Disable request logging for performance (enable for debugging)
disable-logging = true

# Enable cheaper mode for dynamic process scaling
cheaper = 2
cheaper-initial = 2
cheaper-step = 1
cheaper-algo = busyness
cheaper-overload = 30